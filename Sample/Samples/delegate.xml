<?xml version="1.0" encoding="utf-8" ?>
<llpml version="0.13.20080327">

<include src="malloc.xml" />

<?llp
00000000  B878563412        mov eax,0x12345678
00000005  68EFCDAB89        push dword 0x89abcdef
0000000A  FF742410          push dword [esp+0x10]
0000000E  FF74240C          push dword [esp+0xc]
00000012  FF742408          push dword [esp+0x8]
00000016  FF742404          push dword [esp+0x4]
0000001A  FFD0              call eax
0000001C  81C410000000      add esp,0x10
00000022  C21000            ret 0x10
00000025  C3                ret
var f : byte[] = VirtualAlloc(null, 16, MEM_COMMIT, PAGE_EXECUTE_READWRITE);

// mov eax, [esp+4]
f[0] = 0x8b;
f[1] = 0x44;
f[2] = 0x24;
f[3] = 4;

// sub eax, [esp+8]
f[4] = 0x2b;
f[5] = 0x44;
f[6] = 0x24;
f[7] = 8;

// ret
f[8] = 0xc3;

printfln("f(5, 3) = %d", f(5, 3));

VirtualFree(f, 0, MEM_RELEASE);
?>

</llpml>
