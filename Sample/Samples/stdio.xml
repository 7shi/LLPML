<?xml version="1.0" encoding="utf-8" ?>
<llpml version="0.10.20080203">

<!-- stdio functions -->

<extern module="kernel32.dll" type="std" name="GetStdHandle" />
<extern module="kernel32.dll" type="std" suffix="W" name="ReadConsole" />
<extern module="kernel32.dll" type="std" suffix="W" name="WriteConsole" />
<extern module="kernel32.dll" type="std" suffix="W" name="lstrlen" />
<extern module="user32.dll" type="std" suffix="W" name="wvsprintf" />

<?llpml
const int STD_OUTPUT_HANDLE = -11;
const int STD_INPUT_HANDLE  = -10;

var stdout = GetStdHandle(STD_OUTPUT_HANDLE);
var stdin  = GetStdHandle(STD_INPUT_HANDLE);

function print(text)
{
  var length;
  WriteConsole(stdout, text, lstrlen(text), addrof(length), null);
}

function vprintf(format, args)
{
  char buffer[1025];
  wvsprintf(buffer, format, args);
  print(buffer);
}

function vprintfln(format, args)
{
  vprintf(format, args);
  println();
}

function printf(format, args : params)
{
  vprintf(format, args);
}

function println()
{
  print("\r\n");
}

function printfln(format, args : params)
{
  vprintf(format, args);
  println();
}

function pause()
{
  var length;
  char buffer[16];
  ReadConsole(stdin, buffer, 2, addrof(length), null);
}
?>

</llpml>
